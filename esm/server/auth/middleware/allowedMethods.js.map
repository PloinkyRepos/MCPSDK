{"version":3,"file":"allowedMethods.js","sources":["../../../../../src/server/auth/middleware/allowedMethods.ts"],"sourcesContent":["import { RequestHandler } from 'express';\nimport { MethodNotAllowedError } from '../errors.js';\n\n/**\n * Middleware to handle unsupported HTTP methods with a 405 Method Not Allowed response.\n *\n * @param allowedMethods Array of allowed HTTP methods for this endpoint (e.g., ['GET', 'POST'])\n * @returns Express middleware that returns a 405 error if method not in allowed list\n */\nexport function allowedMethods(allowedMethods: string[]): RequestHandler {\n    return (req, res, next) => {\n        if (allowedMethods.includes(req.method)) {\n            next();\n            return;\n        }\n\n        const error = new MethodNotAllowedError(`The method ${req.method} is not allowed for this endpoint`);\n        res.status(405).set('Allow', allowedMethods.join(', ')).json(error.toResponseObject());\n    };\n}\n"],"names":["allowedMethods"],"mappings":";AASO,SAAS,eAAeA,iBAA0C;AACrE,SAAO,CAAC,KAAK,KAAK,SAAS;AACvB,QAAIA,gBAAe,SAAS,IAAI,MAAM,GAAG;AACrC,WAAA;AACA;AAAA,IACJ;AAEA,UAAM,QAAQ,IAAI,sBAAsB,cAAc,IAAI,MAAM,mCAAmC;AACnG,QAAI,OAAO,GAAG,EAAE,IAAI,SAASA,gBAAe,KAAK,IAAI,CAAC,EAAE,KAAK,MAAM,kBAAkB;AAAA,EACzF;AACJ;"}